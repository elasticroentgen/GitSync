{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/13365",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/13365/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/13365/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/13365/events",
  "html_url": "https://github.com/ethereum/solidity/issues/13365",
  "id": 1332989530,
  "node_id": "I_kwDOAm_5kc5Pc85a",
  "number": 13365,
  "title": "Refactored Type Checking and Analysis Annotations",
  "user": {
    "login": "ekpyron",
    "id": 1347491,
    "node_id": "MDQ6VXNlcjEzNDc0OTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ekpyron",
    "html_url": "https://github.com/ekpyron",
    "followers_url": "https://api.github.com/users/ekpyron/followers",
    "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
    "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
    "organizations_url": "https://api.github.com/users/ekpyron/orgs",
    "repos_url": "https://api.github.com/users/ekpyron/repos",
    "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ekpyron/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2022-08-09T09:40:21Z",
  "updated_at": "2022-08-09T12:32:59Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "Currently, the Solidity AST is ``const`` after parsing and then ``annotation()``-annotated by the analysis steps in ``CompilerStack::analyze``.\r\n\r\nHowever, some AST nodes and some Types have interfaces that implicitly depend on annotations. (e.g. for types: ``ContractType::stateVariables``, ``StructType::nativeMembers``; e.g. for AST nodes: ``StructDefinition::type``, ``VariableDeclaration::hasReferenceOrMappingType``, etc.).\r\n\r\nIn the past we regularly had ICEs due to such implicit dependencies. That has gotten better recently, but it's still an easy source of error.\r\n\r\nThis issue is going to get worse, once we want to move to compile-time constant expression evaluation, since this will probably entail switching multiple analysis steps to simultaneous cycle-resistant lazy-evaluation.\r\n\r\nSo we need to come up with a nicer way to:\r\n- Make all implicit dependencies of AST node and Type interfaces explicit. If possible, even syntactically prohibit errors (as in \"too early use\").\r\n- Make the relevant parts of type checking and analysis procedure robust against out-of-order lazy evaluation.\r\n  - Since array lengths should be allowed to be calculated using compile-time constant expressions, this at least entails ``DeclarationTypeChecker`` and ``TypeChecker``, with implicit interactions with ``ContractLevelChecker``.\r\n\r\nPrerequisite of https://github.com/ethereum/solidity/issues/13318",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/13365/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/13365/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[

]
