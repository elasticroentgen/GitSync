{
  "url": "https://api.github.com/repos/ethereum/EIPs/issues/5470",
  "repository_url": "https://api.github.com/repos/ethereum/EIPs",
  "labels_url": "https://api.github.com/repos/ethereum/EIPs/issues/5470/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/EIPs/issues/5470/comments",
  "events_url": "https://api.github.com/repos/ethereum/EIPs/issues/5470/events",
  "html_url": "https://github.com/ethereum/EIPs/issues/5470",
  "id": 1341010200,
  "node_id": "I_kwDOAq426M5P7jEY",
  "number": 5470,
  "title": "ERC 2000: Refundable Token Standard",
  "user": {
    "login": "StartfundInc",
    "id": 111301211,
    "node_id": "U_kgDOBqJSWw",
    "avatar_url": "https://avatars.githubusercontent.com/u/111301211?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/StartfundInc",
    "html_url": "https://github.com/StartfundInc",
    "followers_url": "https://api.github.com/users/StartfundInc/followers",
    "following_url": "https://api.github.com/users/StartfundInc/following{/other_user}",
    "gists_url": "https://api.github.com/users/StartfundInc/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/StartfundInc/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/StartfundInc/subscriptions",
    "organizations_url": "https://api.github.com/users/StartfundInc/orgs",
    "repos_url": "https://api.github.com/users/StartfundInc/repos",
    "events_url": "https://api.github.com/users/StartfundInc/events{/privacy}",
    "received_events_url": "https://api.github.com/users/StartfundInc/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2022-08-17T00:26:41Z",
  "updated_at": "2022-08-17T00:26:41Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "---\r\n\r\neip: 2000\r\ntitle: Refundable Token Standard\r\nauthor: Jerry <jerry@startfund.io>, David <david@startfund.io>, Demi <demi@startfund.io>\r\ntype: Standards Track\r\ncategory: ERC\r\nstatus: Draft\r\ncreated: 2022-08-16\r\n\r\n---\r\n\r\n## Simple Summary\r\n\r\nA standard interface for Refundable Token.\r\n\r\n## Abstract\r\n\r\nThe value of security token can be total sum of linked currencyâ€™s value. For example, Token Issuing  process, issuer can receive money from  buyers( or investors) and transfers issuing token to buyers. If offering process is successfully completed, there is no issue. But buyers can change their plan, or offering is failed(or canceled) cause of mis-fitting the compliance rules or other rules. There is no way guarantee to payback(refund) to buyer in on-chain network.\r\n\r\nWe have suggest this process make possible in on-chain network with payable currency like token(ex: USDT)\r\n\r\n\r\n## Motivation\r\n\r\nA standard interface allows payable token contract to interact with ERC-2000 interface within smart contracts.\r\n\r\nAny payable token contract call ERC-2000 interface to exchange with issuing token based on constraint built in ERC-2000 smart contract to validate transactions.\r\n\r\nNote: Refund is only available in certain conditions(ex: period, oracle value etc) based on implementations.\r\n\r\n## Requirements\r\n\r\nExchanging tokens, requires having an escrow like standard way in on-chain network.\r\n\r\nThe following stand interfaces should be provided on ERC-2000 interface.\r\n  - MUST support querying texted based compliance for transactions. ex: period, max number of buyers, minimum and maximum tokens to hold, refund period, etc.\r\n  - exchange(or purchase) with success or failed return code.\r\n  - refund(or cancel transaction) with success or failed return code.\r\n  - withdraw when escrow process has been success.\r\n\r\n\r\n## Specification\r\n\r\nThe key words \"MUST\", \"MUST NOT\", \"REQUIRED\", \"SHALL\", \"SHALL NOT\", \"SHOULD\", \"SHOULD NOT\", \"RECOMMENDED\", \"MAY\", and \"OPTIONAL\" in this document are to be interpreted as described in RFC 2119.\r\n\r\nThere are 3 contracts for the escrow process: `Buyer Contract`, `Seller Contract` and `Escrow Contract`.\r\n - Buyer Contract: Buyers will pay to escrow account to exchange with `Seller Token`.\r\n - Seller Contract: The seller will pay to escrow account to exchange with `Buyer Token`.\r\n - Escrow Contract: Will be created by seller. Agent to co-operate between buyers and seller based on constraint rules. Instead of simple address mapped balance variable in ERC20 tokens, this balance should have (Seller, Buyer).\r\n\r\n**Every ERC-2000 compliant contract must implement the `ERC2000` interfaces**\r\n\r\n```solidity\r\npragma solidity ^0.4.20;\r\n\r\n/// @title ERC-2000 Refundable Token Standard\r\n\r\ninterface ERC2000 {\r\n\r\n    /// @notice escrow balance of owner\r\n    /// @dev assigned to the zero address are considered invalid, and this\r\n    ///   function throws for queries about the zero address.\r\n    ///   in case of escrow contract,\r\n    ///       recommend return buyer's token balance.\r\n    ///       used for backward compatibility with ERC20 standard.\r\n    /// @param\r\n    ///   - _owner: An address for whom to query the balance\r\n    /// @return amount of current escrow account balance. can be seller's token or buyer's token\r\n    function balanceOf(address account) public view returns (uint256);\r\n\r\n\r\n    /// @notice escrow balance of owner\r\n    /// @dev assigned to the zero address are considered invalid, and this\r\n    ///   function throws for queries about the zero address.\r\n    /// @param\r\n    ///   - _owner: An address for whom to query the balance\r\n    /// @return amount of current escrow account balance. First is buyer token , and seconds is seller token\r\n    function escrowBalanceOf(address account) public view returns (uint256, uint256);\r\n\r\n\r\n    /// @notice simple query to return simple description of compliance.\r\n    /// @dev must implemented in Escrow-Contract and optional for other contracts.\r\n    function escrowComplianceDescription() external view returns (string);\r\n\r\n    /// simple query to return string based on error code. if code is zero, return can be 'success'\r\n    /// @dev must implemented in Escrow-Contract and optional for other contracts.\r\n    function escrowErrorCodeDescription(uint32 _code) external view returns (string);\r\n\r\n\r\n    /// @notice deposit fund(token) into escrow account.\r\n    /// @dev\r\n    ///   - seller/buyer contract should call escrow contract's function before _transfer.\r\n    ///   - escrow contract should update (Seller, Buyer) balance.\r\n    ///   - seller can call this function to fund initial supply.\r\n    /// @param\r\n    ///   - to:\r\n    ///     In case of buyer/seller contract, must be escrow contract address.\r\n    ///     In case of escrow contract, must be user address who is triggered this transaction.\r\n    ///   - _valuePayed: payable token amount\r\n    /// @return reason code. 0 is success, otherwise is failure code.\r\n    function escrowFund(address to, uint256 amount) public returns (uint32);\r\n\r\n\r\n    /// @notice refund from escrow account.\r\n    /// @dev\r\n    ///   - seller/buyer contract should call escrow contract's function before _transfer.\r\n    ///   - escrow contract should update (Seller, Buyer) balance.\r\n    ///   - seller should not call this function.\r\n    /// @param\r\n    ///   - to:\r\n    ///     In case of buyer/seller contract, must be escrow contract address.\r\n    ///     In case of escrow contract, must be user address who is triggered this transaction.\r\n    ///   - _valuePayed: payable token amount\r\n    /// @return reason code. 0 is success, otherwise is failure code.\r\n    function escrowRefund(address to, uint256 amount) public returns (uint32);\r\n\r\n    /// @notice withdraw token from escrow account.\r\n    /// @dev\r\n    ///   - must implemented in Escrow-Contract and optional for other contracts.\r\n    ///   - buyer is only available when escrow is success, otherwise should call escrowRefund.\r\n    ///   - in case of escrow failed, seller can refund seller-token.\r\n    ///   - if escrow is success, seller and buyer can get exchanged token on their own wallet.\r\n    /// @return reason code. 0 is success, otherwise is failure code.\r\n    function escrowWithdraw() public returns (uint32);\r\n\r\n}\r\n\r\n\r\n```\r\n\r\n## Rationale\r\nThe standard proposes interfaces on top of the ERC-20 standard.\r\nEach functions should include constraint check logic.\r\nIn escrow-contract, should implemented internal constraint logic such as period, maximum investors, etc.\r\nThe buyer-contract and seller-contract should not have constraint rules.\r\n\r\nLet's discuss following functions.\r\n\r\n1. **constructor**\r\n\r\nIn escrow contract, will define success/failure conditions. It means constraint rules might not be changed for ever(might be changed after created for market exchange rate.), so it guarantee escrow policy.\r\n\r\n2. **escrowFund**\r\n\r\nThis function should run differently for buyer and seller.\r\n\r\n[seller]\r\n- The seller call this function to be escrow-ready. Seller's token ownership(balance) will be transferred to escrow-contract and escrow balance will be (Seller: amount, Buyer: 0).\r\n- The seller can call this function multiple times depends on implementation, but preferred just one time.\r\n\r\n[buyer]\r\n- When escrow is in running state(not success or failed), the buyer can call this function to deposit fund into escrow account.\r\n- the escrow balance will be (Seller: amount x exchange-rate, Buyer: amount). The `Buyer: amount` will be used for refund process.\r\n- Once it is success, the seller's escrow balance will be (Seller: -= amount x exchange-rate, Buyer: += amount).\r\n\r\n3. **escrowRefund**\r\n\r\nThis function should be invoked by buyers only.\r\nThe buyer can call this function in running state only. In state of failed or success, could not be success.\r\nThe escrow balances of seller and buyer will be updated reverse way of `escrowFund`\r\n\r\n\r\n4. **escrowWithdraw**\r\n\r\nBuyers and seller can withdraw tokens from escrow account to their own account.\r\nThe following processes are recommended.\r\n- Buyer can withdraw in escrow-success state only. Ownership of seller tokens can be transferred to buyer from escrow-contract. In escrow-failed state, buyer should call `escrowRefund` function.\r\n- When the seller call this function in escrow-success state, remained seller token will be transferred to seller, and earned buyer's token will be also transferred from escrow-account.\r\n- In case of escrow-failed, seller only get refund seller token.\r\n\r\n\r\n\r\n## Backwards Compatibility\r\n\r\nBy design ERC-2000 is fully backwards compatible with ERC-20.\r\n\r\n\r\n\r\n## Test Cases & Implementations\r\n\r\n1. [Seller/Buyer Token example](https://github.com/StartfundInc/erc-refundable-token-standard/blob/main/contracts/examples/ERC20Mockup.sol)\r\n\r\n2. [Escrow contract example](https://github.com/StartfundInc/erc-refundable-token-standard/blob/main/contracts/examples/ErcEscrowAccount.sol)\r\n\r\n3. [Unit test example](https://github.com/StartfundInc/erc-refundable-token-standard/blob/main/test/escrow-test.js).\r\n\r\n## Security Considerations\r\n\r\nSince the external contract(Escrow Contract) will control seller or buyer rights, flaws within the escrow contract directly lead to the standardâ€™s unexpected behavior.\r\n\r\n\r\n## Copyright\r\n\r\nCopyright and related rights waived via [CC0](https://eips.ethereum.org/LICENSE).\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/EIPs/issues/5470/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/EIPs/issues/5470/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[

]
