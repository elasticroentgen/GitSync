{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25730",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25730/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25730/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25730/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/25730",
  "id": 1368210126,
  "node_id": "I_kwDOAOvK985RjTrO",
  "number": 25730,
  "title": "Geth refuses to sync after being a few months offline",
  "user": {
    "login": "elsampsa",
    "id": 13978980,
    "node_id": "MDQ6VXNlcjEzOTc4OTgw",
    "avatar_url": "https://avatars.githubusercontent.com/u/13978980?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/elsampsa",
    "html_url": "https://github.com/elsampsa",
    "followers_url": "https://api.github.com/users/elsampsa/followers",
    "following_url": "https://api.github.com/users/elsampsa/following{/other_user}",
    "gists_url": "https://api.github.com/users/elsampsa/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/elsampsa/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/elsampsa/subscriptions",
    "organizations_url": "https://api.github.com/users/elsampsa/orgs",
    "repos_url": "https://api.github.com/users/elsampsa/repos",
    "events_url": "https://api.github.com/users/elsampsa/events{/privacy}",
    "received_events_url": "https://api.github.com/users/elsampsa/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 268304226,
      "node_id": "MDU6TGFiZWwyNjgzMDQyMjY=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:docs",
      "name": "type:docs",
      "color": "fef2c0",
      "default": false,
      "description": null
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2022-09-09T18:55:42Z",
  "updated_at": "2022-09-12T19:23:52Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Weird behaviour from geth when putting a client online after it's been offline for a few months.  I would really appreciate if someone would explain me what's going on / put me on the right track.\r\n\r\nSo far happened:\r\n\r\n- On Jan 22 did a fresh snap sync from scratch.  The blockchain was synced within a matter of days.  Awesome!\r\n- Wen't offline for the summer.  Let's call the  world state before summer \"S0\".\r\n- On Sept 22 went online again & wanted to go POS, so updated to geth 1.10.23 and started using prysm 3.0.0.\r\n- After going online again, geth refuses to reconstruct the current world state \"SC\".\r\n\r\nI am using the \"--syncmode=snap\" option.  When \"--syncmode=snap\" is enabled, I have to admit I am not sure which one of the two ways, (A) or (B), geth is syncing:\r\n\r\nA. The full-node way:\r\n\r\n- Picks up the world state \"S0\" where it was left in before summer.\r\n- Starts executing the blocks, until the state has been updated from \"S0\"->\"SC\"\r\n\r\nB. Snapshot download:\r\n\r\n- Proceeds in downloading state snapshot fragments from other peers\r\n- ..using snapshot packets, reconstructs the state **from scratch** into \"SC\"?\r\n- ..or tries to do an **incremental heal** of \"S0\" --> \"SC\" using snapshot fragments (sounds silly, right?  I guess I'm just imaging this)\r\n\r\nIs there some criteria which one of the two ways geth ends up doing?  Say, if state is enough old, then do (B) instead of (A)?\r\n\r\nObviously, I would prefer (A), since I'm not syncing from scratch.  Should I then remove \"--syncmode=snap\" ?\r\n\r\nNext, let's take a look at the logs:\r\n```\r\nsyys 05 11:28:36 sampsa-asus geth[11610]: INFO [09-05|11:28:36.595] Imported new block headers               count=1    elapsed=4.940ms     number=15,476,571 hash=0cb37e..4b58b2 age=1h51m15s\r\nsyys 05 11:28:46 sampsa-asus geth[11610]: INFO [09-05|11:28:46.906] State heal in progress                   accounts=11,848,726@533.25MiB slots=34,874,749@2.60GiB    codes=107,715@798.25MiB nodes=363,163,945@58.88GiB pending=1\r\nsyys 05 11:29:04 sampsa-asus geth[11610]: WARN [09-05|11:29:04.616] Snapshot extension registration failed   peer=35ba3061 err=\"peer connected on snap without compatible eth support\"\r\nsyys 05 11:29:08 sampsa-asus geth[11610]: INFO [09-05|11:29:08.040] State heal in progress                   accounts=11,848,726@533.25MiB slots=34,874,749@2.60GiB    codes=107,715@798.25MiB nodes=363,163,945@58.88GiB pending=1\r\nsyys 05 11:29:08 sampsa-asus geth[11610]: INFO [09-05|11:29:08.096] Imported new block headers               count=1    elapsed=5.270ms     number=15,476,572 hash=eab73d..75ece5 age=1h51m42s\r\nsyys 05 11:29:08 sampsa-asus geth[11610]: WARN [09-05|11:29:08.098] Dropping unsynced node during sync       id=c83d584aa6a7cf69 conn=inbound addr=146.0.216.163:40678   type=Geth/v1.10.23-stable...\r\nsyys 05 11:29:23 sampsa-asus geth[11610]: WARN [09-05|11:29:23.229] Snapshot extension registration failed   peer=2b87dc19 err=\"peer connected on snap without compatible eth support\"\r\nsyys 05 11:29:27 sampsa-asus geth[11610]: WARN [09-05|11:29:27.443] Snapshot extension registration failed   peer=6de3885d err=\"peer connected on snap without compatible eth support\"\r\nsyys 05 11:30:04 sampsa-asus geth[11610]: INFO [09-05|11:30:04.652] Imported new block headers               count=1    elapsed=5.077ms     number=15,476,573 hash=695338..95f981 age=1h52m27s\r\nsyys 05 11:30:05 sampsa-asus geth[11610]: INFO [09-05|11:30:05.349] Downloader queue stats                   receiptTasks=0     blockTasks=0     itemSize=254.59KiB throttle=1030\r\nsyys 05 11:30:48 sampsa-asus geth[11610]: INFO [09-05|11:30:48.716] Imported new block headers               count=2    elapsed=5.064ms     number=15,476,575 hash=664007..cdd2dd age=1h52m55s\r\nsyys 05 11:30:49 sampsa-asus geth[11610]: WARN [09-05|11:30:49.374] Pivot became stale, moving               old=15,476,449 new=15,476,513\r\nsyys 05 11:30:49 sampsa-asus geth[11610]: INFO [09-05|11:30:49.504] Imported new block receipts              count=64   elapsed=129.241ms   number=15,476,512 hash=14ddfa..f13f36 age=2h9m6s    size=8.55MiB\r\nsyys 05 11:30:49 sampsa-asus geth[11610]: INFO [09-05|11:30:49.504] State heal in progress                   accounts=11,848,726@533.25MiB slots=34,874,749@2.60GiB    codes=107,715@798.25MiB nodes=363,163,945@58.88GiB pending=1\r\nsyys 05 11:30:55 sampsa-asus geth[11610]: INFO [09-05|11:30:55.112] Imported new block headers               count=1    elapsed=4.197ms     number=15,476,576 hash=413332..413f19 age=1h52m57s\r\nsyys 05 11:31:23 sampsa-asus geth[11610]: INFO [09-05|11:31:23.472] Imported new block headers               count=1    elapsed=4.914ms     number=15,476,577 hash=192227..5f294e age=1h52m55s\r\nsyys 05 11:31:24 sampsa-asus geth[11610]: INFO [09-05|11:31:24.524] Downloader queue stats                   receiptTasks=0     blockTasks=0     itemSize=260.17KiB throttle=1008\r\nsyys 05 11:31:36 sampsa-asus geth[11610]: INFO [09-05|11:31:36.180] Imported new block headers               count=2    elapsed=9.148ms     number=15,476,579 hash=1d9258..ef0920 age=1h52m52s\r\nsyys 05 11:32:04 sampsa-asus geth[11610]: INFO [09-05|11:32:04.529] Imported new block headers               count=2    elapsed=6.110ms     number=15,476,581 hash=37288d..497e7a age=1h53m14s\r\nsyys 05 11:32:07 sampsa-asus geth[11610]: INFO [09-05|11:32:07.813] Imported new block headers               count=6    elapsed=17.703ms    number=15,476,587 hash=dbcbde..6a6aa8 age=1h52m40s\r\nsyys 05 11:32:11 sampsa-asus geth[11610]: INFO [09-05|11:32:11.064] Imported new block headers               count=2    elapsed=5.816ms     number=15,476,589 hash=f78c93..d547a7 age=1h52m35s\r\nsyys 05 11:32:14 sampsa-asus geth[11610]: INFO [09-05|11:32:14.329] Imported new block headers               count=1    elapsed=5.343ms     number=15,476,590 hash=1d970a..dbb580 age=1h52m36s\r\nsyys 05 11:32:17 sampsa-asus geth[11610]: INFO [09-05|11:32:17.596] Imported new block headers               count=1    elapsed=5.462ms     number=15,476,591 hash=8efbe0..077eb1 age=1h52m28s\r\nsyys 05 11:32:24 sampsa-asus geth[11610]: INFO [09-05|11:32:24.007] Imported new block headers               count=2    elapsed=13.627ms    number=15,476,593 hash=9d2ae6..f64c80 age=1h51m17s\r\nsyys 05 11:32:24 sampsa-asus geth[11610]: INFO [09-05|11:32:24.562] Downloader queue stats                   receiptTasks=0     blockTasks=0     itemSize=372.89KiB throttle=704\r\nsyys 05 11:32:30 sampsa-asus geth[11610]: INFO [09-05|11:32:30.406] Imported new block headers               count=1    elapsed=5.857ms     number=15,476,594 hash=59a38c..b964ff age=1h50m21s\r\nsyys 05 11:32:33 sampsa-asus geth[11610]: INFO [09-05|11:32:33.696] Imported new block headers               count=1    elapsed=5.346ms     number=15,476,595 hash=a0f7d8..ccb3e3 age=1h50m1s\r\nsyys 05 11:32:40 sampsa-asus geth[11610]: INFO [09-05|11:32:40.090] Imported new block headers               count=3    elapsed=5.102ms     number=15,476,598 hash=961009..fc298a age=1h49m9s\r\nsyys 05 11:32:43 sampsa-asus geth[11610]: INFO [09-05|11:32:43.361] Imported new block headers               count=1    elapsed=4.918ms     number=15,476,599 hash=05bd57..d6f4b9 age=1h49m\r\nsyys 05 11:32:49 sampsa-asus geth[11610]: INFO [09-05|11:32:49.788] Imported new block headers               count=6    elapsed=22.194ms    number=15,476,605 hash=91c36f..a618eb age=1h48m28s\r\nsyys 05 11:32:53 sampsa-asus geth[11610]: INFO [09-05|11:32:53.036] Imported new block headers               count=1    elapsed=4.784ms     number=15,476,606 hash=d3a357..1cb4d0 age=1h48m30s\r\nsyys 05 11:32:56 sampsa-asus geth[11610]: INFO [09-05|11:32:56.313] Imported new block headers               count=1    elapsed=4.866ms     number=15,476,607 hash=c0fc48..6b72f0 age=1h48m30s\r\nsyys 05 11:32:59 sampsa-asus geth[11610]: INFO [09-05|11:32:59.583] Imported new block headers               count=1    elapsed=5.789ms     number=15,476,608 hash=f7470d..d2f3c5 age=1h48m31s\r\n```\r\n\r\n- Blocks are imported at a good pace?  A few milliseconds per block.\r\n- \"Pivot became stale, moving\" : does this has to do something with downloading the snapshot from other peers? .. starting it all over again?  Is it doing (A) or (B) (see above)?\r\n- State heal in progress reports the number of accounts in ethereum.. this should be near hundred millions at the moment?  Why the state is healed/updated soooo slow?  (this is after being a few days online).\r\n\r\nLet's continue:\r\n```\r\nsyys 05 11:50:13 sampsa-asus geth[11610]: INFO [09-05|11:50:13.381] Disabling direct-ancient mode            origin=15,477,053 ancient=14,627,238\r\nsyys 05 11:50:13 sampsa-asus geth[11610]: INFO [09-05|11:50:13.381] State heal in progress                   accounts=11,848,726@533.25MiB slots=34,874,749@2.60GiB    codes=107,715@798.25MiB nodes=363,168,162@58.88GiB pending=1\r\nsyys 05 11:50:13 sampsa-asus geth[11610]: INFO [09-05|11:50:13.750] Imported new block headers               count=9    elapsed=90.869ms    number=15,477,128 hash=8cad3b..8a6686 age=1m10s     ignored=66\r\nsyys 05 11:50:17 sampsa-asus geth[11610]: INFO [09-05|11:50:17.219] Imported new block headers               count=1    elapsed=4.008ms     number=15,477,129 hash=4a8b20..97bd42 age=1m10s\r\nsyys 05 11:50:18 sampsa-asus geth[11610]: INFO [09-05|11:50:18.430] Downloader queue stats                   receiptTasks=0     blockTasks=0     itemSize=262.34KiB throttle=1000\r\nsyys 05 11:50:18 sampsa-asus geth[11610]: INFO [09-05|11:50:18.451] Imported new block receipts              count=10   elapsed=20.515ms    number=15,477,063 hash=68f457..1a4bca age=14m52s    size=2.11MiB\r\nsyys 05 11:50:18 sampsa-asus geth[11610]: INFO [09-05|11:50:18.451] State heal in progress                   accounts=11,848,726@533.25MiB slots=34,874,749@2.60GiB    codes=107,715@798.25MiB nodes=363,168,162@58.88GiB pending=1\r\nsyys 05 11:50:25 sampsa-asus geth[11610]: INFO [09-05|11:50:25.672] Imported new block headers               count=1    elapsed=6.006ms     number=15,477,130 hash=5c6caa..88b273\r\nsyys 05 11:50:29 sampsa-asus geth[11610]: INFO [09-05|11:50:29.716] State heal in progress                   accounts=11,848,726@533.25MiB slots=34,874,749@2.60GiB    codes=107,715@798.25MiB nodes=363,169,396@58.88GiB pending=19532\r\nsyys 05 11:50:40 sampsa-asus geth[11610]: WARN [09-05|11:50:40.869] Snapshot extension registration failed   peer=1125cc47 err=\"peer connected on snap without compatible eth support\"\r\nsyys 05 11:50:47 sampsa-asus geth[11610]: INFO [09-05|11:50:47.686] Imported new block headers               count=1    elapsed=8.713ms     number=15,477,131 hash=0145a7..0ce6dc\r\n```\r\n\r\n- What is disabling direct-ancient mode?  Does it has to do with the problem at hand?\r\n- Note the \"State heal in progress\" reporting number of pending accounts jumping from 1 to 19532.  Why's that?\r\n- Note that donwloaded and verified blocks are practically *there*: \"age=1m10s\"\r\n- Then we have **a lot** of this going on:\r\n```\r\nsyys 05 16:08:19 sampsa-asus geth[11610]: WARN [09-05|16:08:19.561] Unexpected bytecode heal packet          peer=905d36fa reqid=7,304,675,219,279,965,590\r\n```\r\n- what's that about?  Haven't seen a proper explanation of this anywhere.\r\n\r\nThe client was running ~ 4 days until I got fed up and put it offline.  Got this far:\r\n```\r\nsyys 05 16:08:58 sampsa-asus geth[11610]: INFO [09-05|16:08:58.909] State heal in progress                   accounts=12,866,567@579.80MiB slots=37,899,809@2.82GiB    codes=111,459@826.38MiB nodes=371,245,285@60.02GiB pending=188,584\r\n```\r\n\r\nI interprete that downloaded and verified blocks are ok (it seem to reach the latest block occasionally), but the client is unable to reconstruct the up-to-date world state \"SC\".\r\n\r\nI don't understand why.  Once the block is downloaded and verified you get the state change, so what is interfering here with the state update/reconstruction?\r\n\r\nIs there some competition/contradiction going on between (A) and (B)? (see above)\r\n\r\nSome details on my system:\r\n8 x Intel(R) Core(TM) i7-4700HQ CPU @ 2.40GHz\r\n2TB SSD drive: \"Crucial BX500\"\r\n12 GB RAM (& all the swap you could wish for)\r\n(as mentioned, this was able to snapsync from scratch before summer)\r\n\r\nP. S. It would be important to be able to contribute to the network without being a 24/7 avail/on-call eth-client-massage service provider.. to be offline if needed, etc.  Imagine that I'd done staking at this point..!\r\n\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25730/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25730/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1242908491",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25730#issuecomment-1242908491",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25730",
    "id": 1242908491,
    "node_id": "IC_kwDOAOvK985KFUdL",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-11T07:39:51Z",
    "updated_at": "2022-09-11T07:39:51Z",
    "author_association": "MEMBER",
    "body": "It looks like you were not fully snap synced when you shut down your node the last time. You were most likely still in the state heal phase. Otherwise geth would import blocks one by one afterwards. The problem now is that you have a really old state that is not fully healed, so a lot of accounts, balances etc are different than the current state. In the state healing phase these states are fetched one by one from the network. Since they are so many differences between you and the network, the state heal phase will likely never finish. The best way to fix this is to stop geth and remove the old state that you have (via `geth removedb` `y` 'n`). This will force the node to start a new snap sync which should finish in a couple of hours. \r\n\r\nRegarding your PS: nodes can recover very quickly from a couple of days of downtime once they are fully synced (and healed). Since the gas limit in ethereum was voted up and is pretty high atm, the nodes have to do a lot of computation, especially if they want to sync up to the network",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1242908491/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1242994938",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25730#issuecomment-1242994938",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25730",
    "id": 1242994938,
    "node_id": "IC_kwDOAOvK985KFpj6",
    "user": {
      "login": "elsampsa",
      "id": 13978980,
      "node_id": "MDQ6VXNlcjEzOTc4OTgw",
      "avatar_url": "https://avatars.githubusercontent.com/u/13978980?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/elsampsa",
      "html_url": "https://github.com/elsampsa",
      "followers_url": "https://api.github.com/users/elsampsa/followers",
      "following_url": "https://api.github.com/users/elsampsa/following{/other_user}",
      "gists_url": "https://api.github.com/users/elsampsa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/elsampsa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/elsampsa/subscriptions",
      "organizations_url": "https://api.github.com/users/elsampsa/orgs",
      "repos_url": "https://api.github.com/users/elsampsa/repos",
      "events_url": "https://api.github.com/users/elsampsa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/elsampsa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-11T16:06:18Z",
    "updated_at": "2022-09-11T16:06:55Z",
    "author_association": "NONE",
    "body": "Thanks for the reply.  But I am 100% sure that it synced.. checked it form the geth console, etc.\r\n\r\nI guess there's nothing else left to do than to do yet  another snap sync & I keep this ticket still open a few days just in case..\r\n\r\nTo confirm.. once the snap sync is over, after that geth will behave like a normal \"full\" node..  there's no condition/bug? under which it would start a snap sync _again_.   And it's pitty no-one never explains that \"Unexpected bytecode heal packet\"..!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1242994938/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1243017061",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25730#issuecomment-1243017061",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25730",
    "id": 1243017061,
    "node_id": "IC_kwDOAOvK985KFu9l",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-11T18:23:19Z",
    "updated_at": "2022-09-11T18:23:19Z",
    "author_association": "MEMBER",
    "body": "Yes a node will never start a sync again after its been synced once\r\nThe \"unexpected bytecode heal packet\" is printed either when a peer sends us data that we haven't requested or if a reply arrives after the request already timed out (so you request something, the peer takes too long to respond, you stop tracking the request, the peer finally responds)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1243017061/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1243271286",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25730#issuecomment-1243271286",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25730",
    "id": 1243271286,
    "node_id": "IC_kwDOAOvK985KGtB2",
    "user": {
      "login": "elsampsa",
      "id": 13978980,
      "node_id": "MDQ6VXNlcjEzOTc4OTgw",
      "avatar_url": "https://avatars.githubusercontent.com/u/13978980?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/elsampsa",
      "html_url": "https://github.com/elsampsa",
      "followers_url": "https://api.github.com/users/elsampsa/followers",
      "following_url": "https://api.github.com/users/elsampsa/following{/other_user}",
      "gists_url": "https://api.github.com/users/elsampsa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/elsampsa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/elsampsa/subscriptions",
      "organizations_url": "https://api.github.com/users/elsampsa/orgs",
      "repos_url": "https://api.github.com/users/elsampsa/repos",
      "events_url": "https://api.github.com/users/elsampsa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/elsampsa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-12T06:22:13Z",
    "updated_at": "2022-09-12T06:26:35Z",
    "author_association": "NONE",
    "body": "I'm running\r\n```\r\ngeth removedb\r\n```\r\nShould I remove ancient database as well..?\r\n\r\nI keps the ancient database & now it seems to work like a full node..?\r\n```\r\nsyys 12 08:23:08 sampsa-asus geth[2567]: INFO [09-12|08:23:08.248] Imported new block receipts              count=18   elapsed=135.821ms   number=14,627,793 hash=769804..0be43a age=4mo3w2d\r\n....\r\nsyys 12 08:23:03 sampsa-asus geth[2567]: WARN [09-12|08:23:03.989] Pivot seemingly stale, moving            old=15,519,069 new=15,519,133\r\n```\r\nState heal logs missing at the moment\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1243271286/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1244222223",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25730#issuecomment-1244222223",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25730",
    "id": 1244222223,
    "node_id": "IC_kwDOAOvK985KKVMP",
    "user": {
      "login": "aathan",
      "id": 24279435,
      "node_id": "MDQ6VXNlcjI0Mjc5NDM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/24279435?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aathan",
      "html_url": "https://github.com/aathan",
      "followers_url": "https://api.github.com/users/aathan/followers",
      "following_url": "https://api.github.com/users/aathan/following{/other_user}",
      "gists_url": "https://api.github.com/users/aathan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aathan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aathan/subscriptions",
      "organizations_url": "https://api.github.com/users/aathan/orgs",
      "repos_url": "https://api.github.com/users/aathan/repos",
      "events_url": "https://api.github.com/users/aathan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aathan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-12T19:23:52Z",
    "updated_at": "2022-09-12T19:23:52Z",
    "author_association": "NONE",
    "body": "I've spent some time looking around and trying to understand the differences between geth's sync modes but am still left with some open questions. For example: Does a geth node that either snap or fast sync's initially, end up with the same database state as a \"full node\" that has executed all of the transactions since the genesis block? Or does snap sync involve only acquiring a \"digest\" of the storage state of all addresses as of the sync point, such that future requests made to this node for storage as of some older block, would then involve the node making new requests to peers to acquire that older state? Please forgive me if any of this is malformed. I'm asking these questions having made some possibly incorrect assumptions about \"everything.\"\r\n\r\nHaving just written these questions, I thought of a better google query, and found this: https://github.com/ethereum/go-ethereum/issues/24413\r\n\r\nProbably a good idea to incorporate some/all of the wisdom there, into the docs.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1244222223/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
